/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var et=Object.create;var le=Object.defineProperty;var tt=Object.getOwnPropertyDescriptor;var nt=Object.getOwnPropertyNames;var st=Object.getPrototypeOf,it=Object.prototype.hasOwnProperty;var rt=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),ot=(r,t)=>{for(var e in t)le(r,e,{get:t[e],enumerable:!0})},Pe=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of nt(t))!it.call(r,s)&&s!==e&&le(r,s,{get:()=>t[s],enumerable:!(n=tt(t,s))||n.enumerable});return r};var at=(r,t,e)=>(e=r!=null?et(st(r)):{},Pe(t||!r||!r.__esModule?le(e,"default",{value:r,enumerable:!0}):e,r)),ct=r=>Pe(le({},"__esModule",{value:!0}),r);var Ze=rt((Wt,Ne)=>{(function(){"use strict";var r=["\u3131","\u3132","\u3134","\u3137","\u3138","\u3139","\u3141","\u3142","\u3143","\u3145","\u3146","\u3147","\u3148","\u3149","\u314A","\u314B","\u314C","\u314D","\u314E"],t=["\u314F","\u3150","\u3151","\u3152","\u3153","\u3154","\u3155","\u3156","\u3157",["\u3157","\u314F"],["\u3157","\u3150"],["\u3157","\u3163"],"\u315B","\u315C",["\u315C","\u3153"],["\u315C","\u3154"],["\u315C","\u3163"],"\u3160","\u3161",["\u3161","\u3163"],"\u3163"],e=["","\u3131","\u3132",["\u3131","\u3145"],"\u3134",["\u3134","\u3148"],["\u3134","\u314E"],"\u3137","\u3139",["\u3139","\u3131"],["\u3139","\u3141"],["\u3139","\u3142"],["\u3139","\u3145"],["\u3139","\u314C"],["\u3139","\u314D"],["\u3139","\u314E"],"\u3141","\u3142",["\u3142","\u3145"],"\u3145","\u3146","\u3147","\u3148","\u314A","\u314B","\u314C","\u314D","\u314E"],n=44032,s=["\u3131","\u3132","\u3133","\u3134","\u3135","\u3136","\u3137","\u3138","\u3139","\u313A","\u313B","\u313C","\u313D","\u313E","\u313F","\u3140","\u3141","\u3142","\u3143","\u3144","\u3145","\u3146","\u3147","\u3148","\u3149","\u314A","\u314B","\u314C","\u314D","\u314E"],i=["\u3131","\u3132","\u3134","\u3137","\u3138","\u3139","\u3141","\u3142","\u3143","\u3145","\u3146","\u3147","\u3148","\u3149","\u314A","\u314B","\u314C","\u314D","\u314E"],o=["\u314F","\u3150","\u3151","\u3152","\u3153","\u3154","\u3155","\u3156","\u3157","\u3158","\u3159","\u315A","\u315B","\u315C","\u315D","\u315E","\u315F","\u3160","\u3161","\u3162","\u3163"],c=["","\u3131","\u3132","\u3133","\u3134","\u3135","\u3136","\u3137","\u3139","\u313A","\u313B","\u313C","\u313D","\u313E","\u313F","\u3140","\u3141","\u3142","\u3144","\u3145","\u3146","\u3147","\u3148","\u314A","\u314B","\u314C","\u314D","\u314E"],d=[["\u3131","\u3145","\u3133"],["\u3134","\u3148","\u3135"],["\u3134","\u314E","\u3136"],["\u3139","\u3131","\u313A"],["\u3139","\u3141","\u313B"],["\u3139","\u3142","\u313C"],["\u3139","\u3145","\u313D"],["\u3139","\u314C","\u313E"],["\u3139","\u314D","\u313F"],["\u3139","\u314E","\u3140"],["\u3142","\u3145","\u3144"]],l=[["\u3157","\u314F","\u3158"],["\u3157","\u3150","\u3159"],["\u3157","\u3163","\u315A"],["\u315C","\u3153","\u315D"],["\u315C","\u3154","\u315E"],["\u315C","\u3163","\u315F"],["\u3161","\u3163","\u3162"]],h,u,p,y,E,O;function P(a){for(var g=a.length,I={0:0},m=0;m<g;m++)a[m]&&(I[a[m].charCodeAt(0)]=m);return I}h=P(s),u=P(i),p=P(o),y=P(c);function H(a){for(var g=a.length,I={},m,x,w=0;w<g;w++)m=a[w][0].charCodeAt(0),x=a[w][1].charCodeAt(0),typeof I[m]=="undefined"&&(I[m]={}),I[m][x]=a[w][2].charCodeAt(0);return I}E=H(d),O=H(l);function D(a){return typeof h[a]!="undefined"}function k(a){return typeof u[a]!="undefined"}function _(a){return typeof p[a]!="undefined"}function Z(a){return typeof y[a]!="undefined"}function B(a){return 44032<=a&&a<=55203}function F(a,g){return O[a]&&O[a][g]?O[a][g]:!1}function N(a,g){return E[a]&&E[a][g]?E[a][g]:!1}var v=function(a,g){if(a===null)throw new Error("Arguments cannot be null");typeof a=="object"&&(a=a.join(""));for(var I=[],m=a.length,x,w,R,M,b,C=0;C<m;C++){var S=[];M=a.charCodeAt(C),B(M)?(M-=n,R=M%28,w=(M-R)/28%21,x=parseInt((M-R)/28/21),S.push(r[x]),typeof t[w]=="object"?S=S.concat(t[w]):S.push(t[w]),R>0&&(typeof e[R]=="object"?S=S.concat(e[R]):S.push(e[R]))):D(M)?(k(M)?b=r[u[M]]:b=e[y[M]],typeof b=="string"?S.push(b):S=S.concat(b)):_(M)?(b=t[p[M]],typeof b=="string"?S.push(b):S=S.concat(b)):S.push(a.charAt(C)),g?I.push(S):I=I.concat(S)}return I},se=function(a){return typeof a!="string"?"":(a=v(a),a.join(""))},ee=function(a){typeof a=="string"&&(a=v(a));var g=[],I=a.length,m,x=0,w=-1,R,M=!1;function b(S){var J,L,z,ce,V=0,ne,Y="";if(M=!1,!(w+1>S))for(var $=1;;$++){if($===1){if(L=a[w+$].charCodeAt(0),_(L))if(w+$+1<=S&&_(z=a[w+$+1].charCodeAt(0))){g.push(String.fromCharCode(F(L,z))),w=S;return}else{g.push(a[w+$]),w=S;return}else if(!k(L)){g.push(a[w+$]),w=S;return}Y=a[w+$]}else if($===2)if(z=a[w+$].charCodeAt(0),k(z)){L=N(L,z),Y=String.fromCharCode(L),g.push(Y),w=S;return}else Y=String.fromCharCode((u[L]*21+p[z])*28+n);else $===3?(ce=a[w+$].charCodeAt(0),F(z,ce)?z=F(z,ce):V=ce,Y=String.fromCharCode((u[L]*21+p[z])*28+y[V]+n)):$===4?(ne=a[w+$].charCodeAt(0),N(V,ne)?V=N(V,ne):V=ne,Y=String.fromCharCode((u[L]*21+p[z])*28+y[V]+n)):$===5&&(ne=a[w+$].charCodeAt(0),V=N(V,ne),Y=String.fromCharCode((u[L]*21+p[z])*28+y[V]+n));if(w+$>=S){g.push(Y),w=S;return}}}for(var C=0;C<I;C++){if(m=a[C].charCodeAt(0),!k(m)&&!_(m)&&!Z(m)){b(C-1),b(C),x=0;continue}x===0?k(m)?x=1:_(m)&&(x=4):x==1?_(m)?x=2:N(R,m)?x=5:b(C-1):x==2?Z(m)?x=3:_(m)?F(R,m)||(b(C-1),x=4):(b(C-1),x=1):x==3?Z(m)?!M&&N(R,m)?M=!0:(b(C-1),x=1):k(m)?(b(C-1),x=1):_(m)&&(b(C-2),x=2):x==4?_(m)?F(R,m)?(b(C),x=0):b(C-1):(b(C-1),x=1):x==5&&(_(m)?(b(C-2),x=2):(b(C-1),x=1)),R=m}return b(C-1),g.join("")},X=function(a,g){var I=v(a).join(""),m=v(g).join("");return I.indexOf(m)},je=function(a,g){var I=v(a).join(""),m=v(g).join(""),x=v(a,!0),w=new RegExp(m,"gi"),R=[],M;if(!g.length)return[];for(;M=w.exec(I);)R.push(M.index);function b(S){for(var J=0,L=0;J<x.length;++J)if(L+=x[J].length,S<L)return J}function C(S){for(var J=0,L=0;J<x.length;++J)if(L+=x[J].length,S+m.length<=L)return J}return R.map(function(S){return[b(S),C(S)]})};function K(a){this.string=a,this.disassembled=v(a).join("")}K.prototype.search=function(a){return v(a).join("").indexOf(this.disassembled)};var te=function(a){typeof a=="object"&&(a=a.join(""));var g=a.charCodeAt(a.length-1);if(B(g)){g-=n;var I=g%28;if(I>0)return!0}else if(D(g))return!0;return!1},ae=function(a,g){return v(a).pop()===g},we={disassemble:v,d:v,disassembleToString:se,ds:se,assemble:ee,a:ee,search:X,rangeSearch:je,Searcher:K,endsWithConsonant:te,endsWith:ae,isHangul:function(a){return typeof a=="string"&&(a=a.charCodeAt(0)),B(a)},isComplete:function(a){return typeof a=="string"&&(a=a.charCodeAt(0)),B(a)},isConsonant:function(a){return typeof a=="string"&&(a=a.charCodeAt(0)),D(a)},isVowel:function(a){return typeof a=="string"&&(a=a.charCodeAt(0)),_(a)},isCho:function(a){return typeof a=="string"&&(a=a.charCodeAt(0)),k(a)},isJong:function(a){return typeof a=="string"&&(a=a.charCodeAt(0)),Z(a)},isHangulAll:function(a){if(typeof a!="string")return!1;for(var g=0;g<a.length;g++)if(!B(a.charCodeAt(g)))return!1;return!0},isCompleteAll:function(a){if(typeof a!="string")return!1;for(var g=0;g<a.length;g++)if(!B(a.charCodeAt(g)))return!1;return!0},isConsonantAll:function(a){if(typeof a!="string")return!1;for(var g=0;g<a.length;g++)if(!D(a.charCodeAt(g)))return!1;return!0},isVowelAll:function(a){if(typeof a!="string")return!1;for(var g=0;g<a.length;g++)if(!_(a.charCodeAt(g)))return!1;return!0},isChoAll:function(a){if(typeof a!="string")return!1;for(var g=0;g<a.length;g++)if(!k(a.charCodeAt(g)))return!1;return!0},isJongAll:function(a){if(typeof a!="string")return!1;for(var g=0;g<a.length;g++)if(!Z(a.charCodeAt(g)))return!1;return!0}};typeof define=="function"&&define.amd?define(function(){return we}):typeof Ne!="undefined"?Ne.exports=we:window.Hangul=we})()});var zt={};ot(zt,{default:()=>ye});module.exports=ct(zt);var A=require("obsidian");var T=require("obsidian"),He={fuzzyThreshold:.4,overrideQuickSwitcher:!0,indexContent:!0,maxResults:50,showFileSize:!0,showModifiedTime:!0,showScore:!1,enableAutoIndex:!0},he=class extends T.PluginSettingTab{constructor(e,n){super(e,n);this.plugin=n}display(){let{containerEl:e}=this;e.empty(),e.createEl("h1",{text:"\u{1F50D} Korean Search Settings"}),e.createEl("p",{text:"Omnisearch replacement with Korean language support",cls:"setting-item-description"}),e.createEl("h2",{text:"Search Configuration"}),new T.Setting(e).setName("Fuzzy search threshold").setDesc("Controls search sensitivity (0 = exact match, 1 = very loose match)").addSlider(l=>l.setLimits(0,1,.1).setValue(this.plugin.settings.fuzzyThreshold).setDynamicTooltip().onChange(async h=>{this.plugin.settings.fuzzyThreshold=h,await this.plugin.saveSettings(),this.plugin.index.updateThreshold(h)})).addText(l=>l.setValue(this.plugin.settings.fuzzyThreshold.toString()).onChange(async h=>{let u=parseFloat(h);!isNaN(u)&&u>=0&&u<=1&&(this.plugin.settings.fuzzyThreshold=u,await this.plugin.saveSettings(),this.plugin.index.updateThreshold(u))})),new T.Setting(e).setName("Maximum search results").setDesc("Limit the number of results shown (higher = slower)").addSlider(l=>l.setLimits(10,100,10).setValue(this.plugin.settings.maxResults).setDynamicTooltip().onChange(async h=>{this.plugin.settings.maxResults=h,await this.plugin.saveSettings()})),new T.Setting(e).setName("Index file content").setDesc("Search inside file content (not just filenames). May slow down indexing.").addToggle(l=>l.setValue(this.plugin.settings.indexContent).onChange(async h=>{this.plugin.settings.indexContent=h,await this.plugin.saveSettings(),new T.Notice("\u{1F4A1} Consider rebuilding the index after changing this setting",5e3)})),e.createEl("h2",{text:"Interface Settings"}),new T.Setting(e).setName("Override Quick Switcher").setDesc("Replace default Quick Switcher (Cmd/Ctrl+O) with Korean search").addToggle(l=>l.setValue(this.plugin.settings.overrideQuickSwitcher).onChange(async h=>{this.plugin.settings.overrideQuickSwitcher=h,await this.plugin.saveSettings();let u=e.createDiv({text:"\u26A0\uFE0F Please restart Obsidian for this change to take effect.",cls:"setting-item-description mod-warning"});setTimeout(()=>u.remove(),5e3)})),new T.Setting(e).setName("Show file size").setDesc("Display file size in search results").addToggle(l=>l.setValue(this.plugin.settings.showFileSize).onChange(async h=>{this.plugin.settings.showFileSize=h,await this.plugin.saveSettings()})),new T.Setting(e).setName("Show modified time").setDesc("Display last modified time in search results").addToggle(l=>l.setValue(this.plugin.settings.showModifiedTime).onChange(async h=>{this.plugin.settings.showModifiedTime=h,await this.plugin.saveSettings()})),new T.Setting(e).setName("Show search score").setDesc("Display relevance score in results (for debugging)").addToggle(l=>l.setValue(this.plugin.settings.showScore).onChange(async h=>{this.plugin.settings.showScore=h,await this.plugin.saveSettings()})),e.createEl("h2",{text:"Performance Settings"}),new T.Setting(e).setName("Auto-rebuild index").setDesc("Automatically update index when files are created, modified, or deleted").addToggle(l=>l.setValue(this.plugin.settings.enableAutoIndex).onChange(async h=>{this.plugin.settings.enableAutoIndex=h,await this.plugin.saveSettings()})),e.createEl("h2",{text:"Index Management"});let n=e.createDiv({cls:"setting-item"});n.createDiv({text:`\u{1F4CA} Currently indexed: ${this.plugin.index.getIndexedCount()} files`,cls:"setting-item-name"}),new T.Setting(e).setName("Rebuild search index").setDesc("Manually rebuild the entire search index").addButton(l=>l.setButtonText("Rebuild Index").setClass("mod-cta").onClick(async()=>{l.setButtonText("Rebuilding..."),l.setDisabled(!0);try{await this.plugin.index.build(),new T.Notice(`\u2705 Index rebuilt! (${this.plugin.index.getIndexedCount()} files)`,3e3),n.querySelector(".setting-item-name").textContent=`\u{1F4CA} Currently indexed: ${this.plugin.index.getIndexedCount()} files`}catch(h){new T.Notice("\u274C Failed to rebuild index - check console",5e3),console.error("Failed to rebuild index:",h)}finally{l.setButtonText("Rebuild Index"),l.setDisabled(!1)}})),new T.Setting(e).setName("Clear search index").setDesc("Remove all indexed data (will need to rebuild)").addButton(l=>l.setButtonText("Clear Index").setClass("mod-warning").onClick(()=>{this.plugin.index.clear(),new T.Notice("\u{1F5D1}\uFE0F Index cleared",2e3),n.querySelector(".setting-item-name").textContent="\u{1F4CA} Currently indexed: 0 files"}));let o=new T.Setting(e).setName("Korean Search Examples").setDesc("Try these search patterns:").settingEl.createDiv({cls:"hangul-search-examples"}).createEl("ul");o.createEl("li").innerHTML='<strong>\uCD08\uC131 \uAC80\uC0C9:</strong> "\u314E\u3131" \u2192 finds "\uD55C\uAE00", "\uD56D\uACF5", "\uD559\uAD50"',o.createEl("li").innerHTML='<strong>\uBD80\uBD84 \uC74C\uC808:</strong> "\uD55C\u3131" \u2192 finds "\uD55C\uAD6D", "\uD55C\uAE00"',o.createEl("li").innerHTML='<strong>\uD63C\uD569 \uAC80\uC0C9:</strong> "\u314E\u3131\u3139\uAD50" \u2192 finds "\uD55C\uAE00\uD559\uAD50"',o.createEl("li").innerHTML="<strong>\uB0B4\uC6A9 \uAC80\uC0C9:</strong> Searches file content too",o.createEl("li").innerHTML="<strong>\uC601\uC5B4 \uAC80\uC0C9:</strong> Regular English search also works",e.createEl("h2",{text:"Keyboard Shortcuts"});let d=e.createDiv({cls:"hangul-search-examples"}).createEl("ul");d.createEl("li").innerHTML="<strong>Ctrl/Cmd + Shift + O:</strong> Open Korean Search",d.createEl("li").innerHTML="<strong>Ctrl/Cmd + O:</strong> Quick Switcher (if override enabled)",d.createEl("li").innerHTML="<strong>Ctrl + Enter:</strong> Open in new tab",d.createEl("li").innerHTML="<strong>Shift + Enter:</strong> Open in new pane"}};var qe=require("obsidian");function Q(r){return Array.isArray?Array.isArray(r):Qe(r)==="[object Array]"}var lt=1/0;function ht(r){if(typeof r=="string")return r;let t=r+"";return t=="0"&&1/r==-lt?"-0":t}function dt(r){return r==null?"":ht(r)}function W(r){return typeof r=="string"}function We(r){return typeof r=="number"}function ut(r){return r===!0||r===!1||gt(r)&&Qe(r)=="[object Boolean]"}function Ge(r){return typeof r=="object"}function gt(r){return Ge(r)&&r!==null}function j(r){return r!=null}function be(r){return!r.trim().length}function Qe(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}var ft="Incorrect 'index' type",pt=r=>`Invalid value for key ${r}`,mt=r=>`Pattern length exceeds max of ${r}.`,xt=r=>`Missing ${r} property in key`,St=r=>`Property 'weight' in key '${r}' must be a positive integer`,ze=Object.prototype.hasOwnProperty,Ee=class{constructor(t){this._keys=[],this._keyMap={};let e=0;t.forEach(n=>{let s=Ue(n);e+=s.weight,this._keys.push(s),this._keyMap[s.id]=s,e+=s.weight}),this._keys.forEach(n=>{n.weight/=e})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function Ue(r){let t=null,e=null,n=null,s=1,i=null;if(W(r)||Q(r))n=r,t=De(r),e=Ce(r);else{if(!ze.call(r,"name"))throw new Error(xt("name"));let o=r.name;if(n=o,ze.call(r,"weight")&&(s=r.weight,s<=0))throw new Error(St(o));t=De(o),e=Ce(o),i=r.getFn}return{path:t,id:e,weight:s,src:n,getFn:i}}function De(r){return Q(r)?r:r.split(".")}function Ce(r){return Q(r)?r.join("."):r}function yt(r,t){let e=[],n=!1,s=(i,o,c)=>{if(j(i))if(!o[c])e.push(i);else{let d=o[c],l=i[d];if(!j(l))return;if(c===o.length-1&&(W(l)||We(l)||ut(l)))e.push(dt(l));else if(Q(l)){n=!0;for(let h=0,u=l.length;h<u;h+=1)s(l[h],o,c+1)}else o.length&&s(l,o,c+1)}};return s(r,W(t)?t.split("."):t,0),n?e:e[0]}var wt={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},bt={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(r,t)=>r.score===t.score?r.idx<t.idx?-1:1:r.score<t.score?-1:1},Et={location:0,threshold:.6,distance:100},Ct={useExtendedSearch:!1,getFn:yt,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},f={...bt,...wt,...Et,...Ct},vt=/[^ ]+/g;function It(r=1,t=3){let e=new Map,n=Math.pow(10,t);return{get(s){let i=s.match(vt).length;if(e.has(i))return e.get(i);let o=1/Math.pow(i,.5*r),c=parseFloat(Math.round(o*n)/n);return e.set(i,c),c},clear(){e.clear()}}}var ie=class{constructor({getFn:t=f.getFn,fieldNormWeight:e=f.fieldNormWeight}={}){this.norm=It(e,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((e,n)=>{this._keysMap[e.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,W(this.docs[0])?this.docs.forEach((t,e)=>{this._addString(t,e)}):this.docs.forEach((t,e)=>{this._addObject(t,e)}),this.norm.clear())}add(t){let e=this.size();W(t)?this._addString(t,e):this._addObject(t,e)}removeAt(t){this.records.splice(t,1);for(let e=t,n=this.size();e<n;e+=1)this.records[e].i-=1}getValueForItemAtKeyId(t,e){return t[this._keysMap[e]]}size(){return this.records.length}_addString(t,e){if(!j(t)||be(t))return;let n={v:t,i:e,n:this.norm.get(t)};this.records.push(n)}_addObject(t,e){let n={i:e,$:{}};this.keys.forEach((s,i)=>{let o=s.getFn?s.getFn(t):this.getFn(t,s.path);if(j(o)){if(Q(o)){let c=[],d=[{nestedArrIndex:-1,value:o}];for(;d.length;){let{nestedArrIndex:l,value:h}=d.pop();if(j(h))if(W(h)&&!be(h)){let u={v:h,i:l,n:this.norm.get(h)};c.push(u)}else Q(h)&&h.forEach((u,p)=>{d.push({nestedArrIndex:p,value:u})})}n.$[i]=c}else if(W(o)&&!be(o)){let c={v:o,n:this.norm.get(o)};n.$[i]=c}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}};function Xe(r,t,{getFn:e=f.getFn,fieldNormWeight:n=f.fieldNormWeight}={}){let s=new ie({getFn:e,fieldNormWeight:n});return s.setKeys(r.map(Ue)),s.setSources(t),s.create(),s}function Mt(r,{getFn:t=f.getFn,fieldNormWeight:e=f.fieldNormWeight}={}){let{keys:n,records:s}=r,i=new ie({getFn:t,fieldNormWeight:e});return i.setKeys(n),i.setIndexRecords(s),i}function de(r,{errors:t=0,currentLocation:e=0,expectedLocation:n=0,distance:s=f.distance,ignoreLocation:i=f.ignoreLocation}={}){let o=t/r.length;if(i)return o;let c=Math.abs(n-e);return s?o+c/s:c?1:o}function Tt(r=[],t=f.minMatchCharLength){let e=[],n=-1,s=-1,i=0;for(let o=r.length;i<o;i+=1){let c=r[i];c&&n===-1?n=i:!c&&n!==-1&&(s=i-1,s-n+1>=t&&e.push([n,s]),n=-1)}return r[i-1]&&i-n>=t&&e.push([n,i-1]),e}var q=32;function At(r,t,e,{location:n=f.location,distance:s=f.distance,threshold:i=f.threshold,findAllMatches:o=f.findAllMatches,minMatchCharLength:c=f.minMatchCharLength,includeMatches:d=f.includeMatches,ignoreLocation:l=f.ignoreLocation}={}){if(t.length>q)throw new Error(mt(q));let h=t.length,u=r.length,p=Math.max(0,Math.min(n,u)),y=i,E=p,O=c>1||d,P=O?Array(u):[],H;for(;(H=r.indexOf(t,E))>-1;){let F=de(t,{currentLocation:H,expectedLocation:p,distance:s,ignoreLocation:l});if(y=Math.min(F,y),E=H+h,O){let N=0;for(;N<h;)P[H+N]=1,N+=1}}E=-1;let D=[],k=1,_=h+u,Z=1<<h-1;for(let F=0;F<h;F+=1){let N=0,v=_;for(;N<v;)de(t,{errors:F,currentLocation:p+v,expectedLocation:p,distance:s,ignoreLocation:l})<=y?N=v:_=v,v=Math.floor((_-N)/2+N);_=v;let se=Math.max(1,p-v+1),ee=o?u:Math.min(p+v,u)+h,X=Array(ee+2);X[ee+1]=(1<<F)-1;for(let K=ee;K>=se;K-=1){let te=K-1,ae=e[r.charAt(te)];if(O&&(P[te]=+!!ae),X[K]=(X[K+1]<<1|1)&ae,F&&(X[K]|=(D[K+1]|D[K])<<1|1|D[K+1]),X[K]&Z&&(k=de(t,{errors:F,currentLocation:te,expectedLocation:p,distance:s,ignoreLocation:l}),k<=y)){if(y=k,E=te,E<=p)break;se=Math.max(1,2*p-E)}}if(de(t,{errors:F+1,currentLocation:p,expectedLocation:p,distance:s,ignoreLocation:l})>y)break;D=X}let B={isMatch:E>=0,score:Math.max(.001,k)};if(O){let F=Tt(P,c);F.length?d&&(B.indices=F):B.isMatch=!1}return B}function Ft(r){let t={};for(let e=0,n=r.length;e<n;e+=1){let s=r.charAt(e);t[s]=(t[s]||0)|1<<n-e-1}return t}var ue=class{constructor(t,{location:e=f.location,threshold:n=f.threshold,distance:s=f.distance,includeMatches:i=f.includeMatches,findAllMatches:o=f.findAllMatches,minMatchCharLength:c=f.minMatchCharLength,isCaseSensitive:d=f.isCaseSensitive,ignoreLocation:l=f.ignoreLocation}={}){if(this.options={location:e,threshold:n,distance:s,includeMatches:i,findAllMatches:o,minMatchCharLength:c,isCaseSensitive:d,ignoreLocation:l},this.pattern=d?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;let h=(p,y)=>{this.chunks.push({pattern:p,alphabet:Ft(p),startIndex:y})},u=this.pattern.length;if(u>q){let p=0,y=u%q,E=u-y;for(;p<E;)h(this.pattern.substr(p,q),p),p+=q;if(y){let O=u-q;h(this.pattern.substr(O),O)}}else h(this.pattern,0)}searchIn(t){let{isCaseSensitive:e,includeMatches:n}=this.options;if(e||(t=t.toLowerCase()),this.pattern===t){let E={isMatch:!0,score:0};return n&&(E.indices=[[0,t.length-1]]),E}let{location:s,distance:i,threshold:o,findAllMatches:c,minMatchCharLength:d,ignoreLocation:l}=this.options,h=[],u=0,p=!1;this.chunks.forEach(({pattern:E,alphabet:O,startIndex:P})=>{let{isMatch:H,score:D,indices:k}=At(t,E,O,{location:s+P,distance:i,threshold:o,findAllMatches:c,minMatchCharLength:d,includeMatches:n,ignoreLocation:l});H&&(p=!0),u+=D,H&&k&&(h=[...h,...k])});let y={isMatch:p,score:p?u/this.chunks.length:1};return p&&n&&(y.indices=h),y}},G=class{constructor(t){this.pattern=t}static isMultiMatch(t){return Be(t,this.multiRegex)}static isSingleMatch(t){return Be(t,this.singleRegex)}search(){}};function Be(r,t){let e=r.match(t);return e?e[1]:null}var ve=class extends G{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){let e=t===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}},Ie=class extends G{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){let n=t.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}},Me=class extends G{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){let e=t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}},Te=class extends G{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){let e=!t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},Ae=class extends G{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){let e=t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[t.length-this.pattern.length,t.length-1]}}},Fe=class extends G{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){let e=!t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},ge=class extends G{constructor(t,{location:e=f.location,threshold:n=f.threshold,distance:s=f.distance,includeMatches:i=f.includeMatches,findAllMatches:o=f.findAllMatches,minMatchCharLength:c=f.minMatchCharLength,isCaseSensitive:d=f.isCaseSensitive,ignoreLocation:l=f.ignoreLocation}={}){super(t),this._bitapSearch=new ue(t,{location:e,threshold:n,distance:s,includeMatches:i,findAllMatches:o,minMatchCharLength:c,isCaseSensitive:d,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}},fe=class extends G{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let e=0,n,s=[],i=this.pattern.length;for(;(n=t.indexOf(this.pattern,e))>-1;)e=n+i,s.push([n,e-1]);let o=!!s.length;return{isMatch:o,score:o?0:1,indices:s}}},Oe=[ve,fe,Me,Te,Fe,Ae,Ie,ge],Je=Oe.length,Ot=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,_t="|";function Lt(r,t={}){return r.split(_t).map(e=>{let n=e.trim().split(Ot).filter(i=>i&&!!i.trim()),s=[];for(let i=0,o=n.length;i<o;i+=1){let c=n[i],d=!1,l=-1;for(;!d&&++l<Je;){let h=Oe[l],u=h.isMultiMatch(c);u&&(s.push(new h(u,t)),d=!0)}if(!d)for(l=-1;++l<Je;){let h=Oe[l],u=h.isSingleMatch(c);if(u){s.push(new h(u,t));break}}}return s})}var $t=new Set([ge.type,fe.type]),_e=class{constructor(t,{isCaseSensitive:e=f.isCaseSensitive,includeMatches:n=f.includeMatches,minMatchCharLength:s=f.minMatchCharLength,ignoreLocation:i=f.ignoreLocation,findAllMatches:o=f.findAllMatches,location:c=f.location,threshold:d=f.threshold,distance:l=f.distance}={}){this.query=null,this.options={isCaseSensitive:e,includeMatches:n,minMatchCharLength:s,findAllMatches:o,ignoreLocation:i,location:c,threshold:d,distance:l},this.pattern=e?t:t.toLowerCase(),this.query=Lt(this.pattern,this.options)}static condition(t,e){return e.useExtendedSearch}searchIn(t){let e=this.query;if(!e)return{isMatch:!1,score:1};let{includeMatches:n,isCaseSensitive:s}=this.options;t=s?t:t.toLowerCase();let i=0,o=[],c=0;for(let d=0,l=e.length;d<l;d+=1){let h=e[d];o.length=0,i=0;for(let u=0,p=h.length;u<p;u+=1){let y=h[u],{isMatch:E,indices:O,score:P}=y.search(t);if(E){if(i+=1,c+=P,n){let H=y.constructor.type;$t.has(H)?o=[...o,...O]:o.push(O)}}else{c=0,i=0,o.length=0;break}}if(i){let u={isMatch:!0,score:c/i};return n&&(u.indices=o),u}}return{isMatch:!1,score:1}}},Le=[];function kt(...r){Le.push(...r)}function $e(r,t){for(let e=0,n=Le.length;e<n;e+=1){let s=Le[e];if(s.condition(r,t))return new s(r,t)}return new ue(r,t)}var pe={AND:"$and",OR:"$or"},ke={PATH:"$path",PATTERN:"$val"},Re=r=>!!(r[pe.AND]||r[pe.OR]),Rt=r=>!!r[ke.PATH],Nt=r=>!Q(r)&&Ge(r)&&!Re(r),Ve=r=>({[pe.AND]:Object.keys(r).map(t=>({[t]:r[t]}))});function Ye(r,t,{auto:e=!0}={}){let n=s=>{let i=Object.keys(s),o=Rt(s);if(!o&&i.length>1&&!Re(s))return n(Ve(s));if(Nt(s)){let d=o?s[ke.PATH]:i[0],l=o?s[ke.PATTERN]:s[d];if(!W(l))throw new Error(pt(d));let h={keyId:Ce(d),pattern:l};return e&&(h.searcher=$e(l,t)),h}let c={children:[],operator:i[0]};return i.forEach(d=>{let l=s[d];Q(l)&&l.forEach(h=>{c.children.push(n(h))})}),c};return Re(r)||(r=Ve(r)),n(r)}function Kt(r,{ignoreFieldNorm:t=f.ignoreFieldNorm}){r.forEach(e=>{let n=1;e.matches.forEach(({key:s,norm:i,score:o})=>{let c=s?s.weight:null;n*=Math.pow(o===0&&c?Number.EPSILON:o,(c||1)*(t?1:i))}),e.score=n})}function jt(r,t){let e=r.matches;t.matches=[],j(e)&&e.forEach(n=>{if(!j(n.indices)||!n.indices.length)return;let{indices:s,value:i}=n,o={indices:s,value:i};n.key&&(o.key=n.key.src),n.idx>-1&&(o.refIndex=n.idx),t.matches.push(o)})}function Pt(r,t){t.score=r.score}function Ht(r,t,{includeMatches:e=f.includeMatches,includeScore:n=f.includeScore}={}){let s=[];return e&&s.push(jt),n&&s.push(Pt),r.map(i=>{let{idx:o}=i,c={item:t[o],refIndex:o};return s.length&&s.forEach(d=>{d(i,c)}),c})}var U=class{constructor(t,e={},n){this.options={...f,...e},this.options.useExtendedSearch,this._keyStore=new Ee(this.options.keys),this.setCollection(t,n)}setCollection(t,e){if(this._docs=t,e&&!(e instanceof ie))throw new Error(ft);this._myIndex=e||Xe(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){j(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){let e=[];for(let n=0,s=this._docs.length;n<s;n+=1){let i=this._docs[n];t(i,n)&&(this.removeAt(n),n-=1,s-=1,e.push(i))}return e}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:e=-1}={}){let{includeMatches:n,includeScore:s,shouldSort:i,sortFn:o,ignoreFieldNorm:c}=this.options,d=W(t)?W(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return Kt(d,{ignoreFieldNorm:c}),i&&d.sort(o),We(e)&&e>-1&&(d=d.slice(0,e)),Ht(d,this._docs,{includeMatches:n,includeScore:s})}_searchStringList(t){let e=$e(t,this.options),{records:n}=this._myIndex,s=[];return n.forEach(({v:i,i:o,n:c})=>{if(!j(i))return;let{isMatch:d,score:l,indices:h}=e.searchIn(i);d&&s.push({item:i,idx:o,matches:[{score:l,value:i,norm:c,indices:h}]})}),s}_searchLogical(t){let e=Ye(t,this.options),n=(c,d,l)=>{if(!c.children){let{keyId:u,searcher:p}=c,y=this._findMatches({key:this._keyStore.get(u),value:this._myIndex.getValueForItemAtKeyId(d,u),searcher:p});return y&&y.length?[{idx:l,item:d,matches:y}]:[]}let h=[];for(let u=0,p=c.children.length;u<p;u+=1){let y=c.children[u],E=n(y,d,l);if(E.length)h.push(...E);else if(c.operator===pe.AND)return[]}return h},s=this._myIndex.records,i={},o=[];return s.forEach(({$:c,i:d})=>{if(j(c)){let l=n(e,c,d);l.length&&(i[d]||(i[d]={idx:d,item:c,matches:[]},o.push(i[d])),l.forEach(({matches:h})=>{i[d].matches.push(...h)}))}}),o}_searchObjectList(t){let e=$e(t,this.options),{keys:n,records:s}=this._myIndex,i=[];return s.forEach(({$:o,i:c})=>{if(!j(o))return;let d=[];n.forEach((l,h)=>{d.push(...this._findMatches({key:l,value:o[h],searcher:e}))}),d.length&&i.push({idx:c,item:o,matches:d})}),i}_findMatches({key:t,value:e,searcher:n}){if(!j(e))return[];let s=[];if(Q(e))e.forEach(({v:i,i:o,n:c})=>{if(!j(i))return;let{isMatch:d,score:l,indices:h}=n.searchIn(i);d&&s.push({score:l,key:t,value:i,idx:o,norm:c,indices:h})});else{let{v:i,n:o}=e,{isMatch:c,score:d,indices:l}=n.searchIn(i);c&&s.push({score:d,key:t,value:i,norm:o,indices:l})}return s}};U.version="6.6.2";U.createIndex=Xe;U.parseIndex=Mt;U.config=f;U.parseQuery=Ye;kt(_e);var Ke=at(Ze()),me=class{constructor(t){this.plugin=t;this.entries=[];this.indexMap=new Map;this.defaultThreshold=.6;this.contentCache=new Map;this.initialConsonantIndex=new Map;this.jamoIndex=new Map;this.ngramIndex=new Map;this.decompositionCache=new Map}async build(){console.log("\u{1F50D} Building Korean Omnisearch index (fast mode)...");let t=this.plugin.app.vault.getMarkdownFiles();this.entries=[],this.indexMap.clear(),this.contentCache.clear();let e=0;for(let n of t)try{await this.addFileMetadata(n),e++}catch(s){console.warn(`Failed to index metadata for ${n.path}:`,s)}this.rebuildFuse(),console.log(`\u2705 Korean Omnisearch index completed: ${e} files (fast mode)`)}async addFileMetadata(t){if(!(!t||t.extension!=="md"))try{let e=this.createMetadataEntry(t);this.indexMap.has(t.path)&&this.removeFile(t,!0),this.entries.push(e),this.indexMap.set(t.path,e)}catch(e){console.warn(`Failed to add metadata for ${t.path}:`,e)}}createMetadataEntry(t){let e=t.basename,n=t.path,s=this.decomposeKoreanText(e);return(e.includes("\uD55C")||e.includes("\u314E"))&&console.log(`\u{1F4DD} Indexing Korean file: "${e}" \u2192 jamo: "${s}"`),{display:e,jamo:s,path:n,content:"",contentJamo:"",score:0,size:t.stat.size,mtime:t.stat.mtime,contentLoaded:!1}}async loadFileContent(t){if(!t.contentLoaded)try{let e=this.contentCache.get(t.path);if(e){t.content=e.content,t.contentJamo=e.contentJamo,t.contentLoaded=!0;return}let n=this.plugin.app.vault.getAbstractFileByPath(t.path);if(n instanceof qe.TFile){let i=(await this.plugin.app.vault.cachedRead(n)).substring(0,500),o=this.decomposeKoreanText(i);this.contentCache.set(t.path,{content:i,contentJamo:o}),t.content=i,t.contentJamo=o,t.contentLoaded=!0}}catch(e){console.warn(`Failed to load content for ${t.path}:`,e),t.contentLoaded=!0}}async addFile(t,e=!1){await this.addFileMetadata(t),e||this.rebuildFuse()}removeFile(t,e=!1){let n=this.indexMap.get(t.path);if(!n)return;let s=this.entries.indexOf(n);s>-1&&(this.entries.splice(s,1),this.indexMap.delete(t.path),e||this.rebuildFuse())}async updateFile(t){!t||t.extension!=="md"||(this.removeFile(t),await this.addFile(t))}updateOnRename(t,e){this.indexMap.get(e)&&(this.removeFile({path:e}),this.addFile(t))}search(t,e=50){if(!t.trim())return[];if(console.log(`\u{1F50D} Searching: "${t}"`),console.log(`\u{1F4CA} Index has ${this.entries.length} entries`),this.entries.length>0){let i=this.entries[0];console.log(`\u{1F4DD} Sample entry: "${i.display}" \u2192 jamo: "${i.jamo}"`)}let n=this.performKoreanSearch(t);console.log(`\u{1F4CA} Found ${n.length} results`);let s=n.sort((i,o)=>o.score-i.score).slice(0,Math.min(e*2,100));return this.loadContentForTopResults(s.slice(0,20)),s.slice(0,e)}async loadContentForTopResults(t){for(let n=0;n<t.length;n+=5){let s=t.slice(n,n+5);await Promise.all(s.map(i=>this.loadFileContent(i))),n+5<t.length&&await new Promise(i=>setTimeout(i,1))}}performKoreanSearch(t){let e=new Map;this.searchByStrategy(t,e,"direct");let n=this.decomposeKoreanText(t);return n!==t&&(console.log(`\u{1F50D} Using decomposed search: "${n}"`),this.searchByStrategy(n,e,"decomposed")),this.isInitialConsonantQuery(t)&&(console.log(`\u{1F50D} Initial consonant search: "${t}"`),this.searchByInitialConsonants(t,e)),this.isPartialSyllableQuery(t)&&(console.log(`\u{1F50D} Partial syllable search: "${t}"`),this.searchByPartialSyllables(t,e)),Array.from(e.values())}searchByStrategy(t,e,n){this.fuse||(console.warn("\u26A0\uFE0F Search index not ready, rebuilding..."),this.rebuildFuse()),console.log(`\u{1F50D} Fuse search for "${t}" (strategy: ${n})`);let s=this.fuse.search(t,{limit:50});console.log(`\u{1F4CA} Fuse returned ${s.length} results for "${t}"`),s.length>0&&console.log(`\u{1F4DD} First result: "${s[0].item.display}" (score: ${s[0].score})`),s.forEach(i=>{let o=i.item,c=this.calculateRelevanceScore(o,t,i.score||0,n);(!e.has(o.path)||e.get(o.path).score<c)&&e.set(o.path,{...o,score:c})})}searchByInitialConsonants(t,e){let n=this.initialConsonantIndex.get(t)||[],s=[];for(let[i,o]of this.initialConsonantIndex)i.includes(t)&&i!==t&&s.push(...o);[...n,...s].forEach(i=>{let o=this.calculateRelevanceScore(i,t,.3,"initial-consonant");(!e.has(i.path)||e.get(i.path).score<o)&&e.set(i.path,{...i,score:o})}),console.log(`\u{1F50D} Initial consonant search: ${n.length} direct + ${s.length} subsequence matches`)}searchByPartialSyllables(t,e){let n=new Set,s=this.decomposeKoreanText(t);for(let i=0;i<s.length;i++){let o=s[i];if((this.jamoIndex.get(o)||[]).forEach(d=>n.add(d)),i<s.length-1){let d=s.substring(i,i+2);(this.ngramIndex.get(d)||[]).forEach(h=>n.add(h))}if(i<s.length-2){let d=s.substring(i,i+3);(this.ngramIndex.get(d)||[]).forEach(h=>n.add(h))}}n.forEach(i=>{if(this.matchesPartialSyllable(i.display,t)){let o=this.calculateRelevanceScore(i,t,.2,"partial-syllable");(!e.has(i.path)||e.get(i.path).score<o)&&e.set(i.path,{...i,score:o})}}),console.log(`\u{1F50D} Partial syllable search: ${n.size} candidates filtered`)}isInitialConsonantQuery(t){return/^[ㄱ-ㅎ]+$/.test(t)}isPartialSyllableQuery(t){let e=/[가-힣]/.test(t),n=/[ㄱ-ㅎ]/.test(t);return e&&n}extractInitialConsonants(t){return t.split("").map(e=>/[가-힣]/.test(e)&&Ke.default.disassemble(e)[0]||e).join("")}matchesPartialSyllable(t,e){let n=this.decomposeKoreanText(t),s=this.decomposeKoreanText(e);return n.includes(s)}decomposeKoreanText(t){if(this.decompositionCache.has(t))return this.decompositionCache.get(t);try{let e=Ke.default.disassemble(t).join("");return this.decompositionCache.set(t,e),e}catch(e){return console.warn("Failed to decompose Korean text:",t,e),this.decompositionCache.set(t,t),t}}updateThreshold(t){try{this.plugin.settings&&(this.plugin.settings.fuzzyThreshold=t),this.rebuildFuse()}catch(e){console.warn("Could not update plugin settings, using default threshold"),this.rebuildFuse()}}getIndexedCount(){return this.entries.length}clear(){this.entries=[],this.indexMap.clear(),this.contentCache.clear(),this.initialConsonantIndex.clear(),this.jamoIndex.clear(),this.ngramIndex.clear(),this.decompositionCache.clear(),this.rebuildFuse()}calculateRelevanceScore(t,e,n,s){var l;let i=1-n;switch(s){case"direct":i+=5;break;case"initial-consonant":i+=3;break;case"partial-syllable":i+=2;break;case"decomposed":i+=1;break}let o=e.toLowerCase(),c=t.display.toLowerCase();return c===o?i+=10:c.includes(o)&&(i+=5),(l=t.content)!=null&&l.toLowerCase().includes(o)&&(i+=2),(Date.now()-t.mtime)/(1e3*60*60*24)<7&&(i+=1),t.size<1e3&&(i+=.5),i}rebuildFuse(){var t;try{let e=((t=this.plugin.settings)==null?void 0:t.fuzzyThreshold)||this.defaultThreshold;if(console.log(`\u{1F527} Rebuilding Fuse index with ${this.entries.length} entries`),this.entries.length>0){let n=this.entries.filter(s=>s.display.match(/[가-힣]/));console.log(`\u{1F4CA} Korean files found: ${n.length}`),n.length>0&&console.log(`\u{1F4DD} Sample Korean entry: "${n[0].display}" \u2192 jamo: "${n[0].jamo}"`)}this.fuse=new U(this.entries,{threshold:e,keys:[{name:"jamo",weight:.7},{name:"display",weight:.3}],includeScore:!0,minMatchCharLength:1,ignoreLocation:!0,includeMatches:!1,shouldSort:!0,findAllMatches:!1,useExtendedSearch:!1}),this.buildSearchIndexes(),console.log(`\u{1F527} Search index updated: ${this.entries.length} entries (optimized mode)`)}catch(e){console.error("\u274C Failed to rebuild search index:",e)}}async batchAddFiles(t){let e=0;for(let n of t)try{await this.addFileMetadata(n),e++}catch(s){console.warn(`Failed to index metadata for ${n.path}:`,s)}return this.rebuildFuse(),e}buildSearchIndexes(){console.log("\u{1F527} Building optimized Korean search indexes..."),this.initialConsonantIndex.clear(),this.jamoIndex.clear(),this.ngramIndex.clear(),this.entries.forEach(t=>{let e=this.extractInitialConsonants(t.display);this.addToIndex(this.initialConsonantIndex,e,t);let n=t.jamo;for(let i=0;i<n.length;i++)this.addToIndex(this.jamoIndex,n[i],t),i<n.length-1&&this.addToIndex(this.ngramIndex,n.substring(i,i+2),t),i<n.length-2&&this.addToIndex(this.ngramIndex,n.substring(i,i+3),t);let s=t.display.toLowerCase();for(let i=0;i<s.length;i++)this.addToIndex(this.jamoIndex,s[i],t),i<s.length-1&&this.addToIndex(this.ngramIndex,s.substring(i,i+2),t)}),console.log(`\u2705 Search indexes built: ${this.initialConsonantIndex.size} consonant patterns, ${this.ngramIndex.size} n-grams`)}addToIndex(t,e,n){e&&(t.has(e)||t.set(e,[]),t.get(e).push(n))}};var re=require("obsidian"),oe=class extends re.SuggestModal{constructor(e,n){super(e);this.index=n;this.setPlaceholder("\u{1F50D} Korean Search: Try \u314E\u3131, \uD55C\u3131, or \u314E\u3131\u3139\uAD50..."),this.setInstructions([{command:"\u2191\u2193",purpose:"to navigate"},{command:"\u21B5",purpose:"to open"},{command:"Ctrl \u21B5",purpose:"to open in new tab"},{command:"Shift \u21B5",purpose:"to open in new pane"},{command:"esc",purpose:"to dismiss"}])}getSuggestions(e){if(console.log(`\u{1F50D} HangulSwitcher.getSuggestions() called with query: "${e}"`),!e||e.trim().length===0){let s=this.getRecentFiles();return console.log(`\u{1F4C2} Showing ${s.length} recent files for empty query`),s}let n=this.index.search(e,50);return console.log(`\u2705 HangulSwitcher returning ${n.length} results for "${e}"`),n.length>0&&console.log("\u{1F4DD} First few results:",n.slice(0,3).map(s=>s.display)),n}renderSuggestion(e,n){console.log(`\u{1F3A8} Rendering suggestion: ${e.display}`),n.empty(),n.addClass("hangul-search-result");let s=n.createDiv({cls:"hangul-search-result-container"});s.createDiv({cls:"hangul-search-title"}).setText(e.display),e.path!==e.display&&s.createDiv({cls:"hangul-search-path"}).setText(e.path),e.content&&e.content.trim()&&s.createDiv({cls:"hangul-search-content"}).setText(e.content.substring(0,100)+"...");let o=s.createDiv({cls:"hangul-search-meta"}),c=this.formatFileSize(e.size);o.createSpan({cls:"hangul-search-size",text:c});let d=this.formatRelativeTime(e.mtime);o.createSpan({cls:"hangul-search-time",text:d}),e.score>0&&o.createSpan({cls:"hangul-search-score",text:`Score: ${e.score.toFixed(2)}`})}onChooseSuggestion(e,n){var c;let s=this.app.vault.getAbstractFileByPath(e.path);if(!(s instanceof re.TFile)){console.error(`\u274C File not found: ${e.path}`);return}let i=(n==null?void 0:n.ctrlKey)||(n==null?void 0:n.ctrlKey),o=(n==null?void 0:n.shiftKey)||(n==null?void 0:n.shiftKey);console.log(`\u{1F4C2} Opening file: ${e.path} (newLeaf: ${i}, newPane: ${o})`),o?this.app.workspace.getLeaf("split").openFile(s):i?this.app.workspace.getLeaf("tab").openFile(s):(c=this.app.workspace.activeLeaf)==null||c.openFile(s)}getRecentFiles(){try{return this.app.workspace.getLastOpenFiles().slice(0,10).map(n=>{let s=this.app.vault.getAbstractFileByPath(n);return s instanceof re.TFile?{display:s.basename,jamo:s.basename,path:s.path,content:"Recently opened file",contentJamo:"",score:0,size:s.stat.size,mtime:s.stat.mtime}:null}).filter(Boolean)}catch(e){return console.error("\u274C Error getting recent files:",e),[]}}formatFileSize(e){return e<1024?`${e}B`:e<1024*1024?`${(e/1024).toFixed(1)}KB`:`${(e/(1024*1024)).toFixed(1)}MB`}formatRelativeTime(e){let s=Date.now()-e,i=Math.floor(s/(1e3*60*60*24)),o=Math.floor(s/(1e3*60*60)),c=Math.floor(s/(1e3*60));return i>0?`${i}d ago`:o>0?`${o}h ago`:c>0?`${c}m ago`:"Just now"}};var Se=require("obsidian"),xe=class extends Se.EditorSuggest{constructor(e,n){super(e);this.index=n}onTrigger(e,n){let o=n.getLine(e.line).substring(0,e.ch).match(/\[\[([^\]]*?)$/);return o?{start:{line:e.line,ch:e.ch-o[1].length},end:e,query:o[1]}:null}getSuggestions(e){let n=e.query;return n?this.index.search(n,20):this.getRecentFiles()}renderSuggestion(e,n){let s=n.createDiv();s.createDiv({cls:"hangul-link-title"}).setText(e.display),e.path!==e.display&&s.createDiv({cls:"hangul-link-path"}).setText(e.path)}selectSuggestion(e){var h;let n=(h=this.context)==null?void 0:h.editor;if(!n)return;let s=n.getCursor(),c=n.getLine(s.line).substring(0,s.ch).match(/\[\[([^\]]*?)$/);if(!c)return;let d=s.ch-c[1].length,l=s.ch;n.replaceRange(e.display+"]]",{line:s.line,ch:d},{line:s.line,ch:l})}getRecentFiles(){return this.app.workspace.getLastOpenFiles().slice(0,10).map(n=>{let s=this.app.vault.getAbstractFileByPath(n);return s instanceof Se.TFile?{display:s.basename,jamo:s.basename,path:s.path,content:"Recently opened file",contentJamo:"",score:0,size:s.stat.size,mtime:s.stat.mtime}:null}).filter(Boolean)}};var ye=class extends A.Plugin{async onload(){console.log("\u{1F525} Korean Omnisearch: Starting...");try{await this.loadSettings(),console.log("\u2705 Settings loaded"),this.index=new me(this),console.log("\u2705 Search index initialized"),this.addCoreCommands(),console.log("\u2705 Commands registered"),this.registerVaultEvents(),console.log("\u2705 Vault events registered"),this.registerEditorSuggest(new xe(this.app,this.index)),console.log("\u2705 Korean link suggestions enabled"),this.addSettingTab(new he(this.app,this)),console.log("\u2705 Settings tab added"),new A.Notice("\u2705 Korean Omnisearch ready! Building index in background...",3e3),console.log("\u{1F389} Korean Omnisearch ready! Starting background indexing..."),this.buildIndexProgressively()}catch(e){console.error("\u274C Korean Omnisearch failed to load:",e),new A.Notice("\u274C Korean Omnisearch failed to load - check console for details",5e3)}}addCoreCommands(){this.addCommand({id:"korean-search",name:"Open Korean Omnisearch",hotkeys:[{modifiers:["Mod","Shift"],key:"o"}],callback:()=>{try{console.log("\u{1F50D} Opening Korean Omnisearch..."),new oe(this.app,this.index).open()}catch(e){console.error("\u274C Error opening Korean Omnisearch:",e),new A.Notice("\u274C Error opening Korean Omnisearch - check console for details")}}}),this.addCommand({id:"korean-search-quick",name:"Korean Omnisearch with Examples",callback:()=>{new A.Notice("\u{1F50D} Korean Omnisearch Patterns: \u314E\u3131 (\uCD08\uC131), \uD55C\u3131 (\uBD80\uBD84), \u314E\u3131\u3139\uAD50 (\uD63C\uD569)",5e3),new oe(this.app,this.index).open()}}),this.addCommand({id:"hangul-rebuild-index",name:"Rebuild Korean Omnisearch Index",callback:async()=>{let e=new A.Notice("\u{1F504} Rebuilding Korean Omnisearch index...",0);try{await this.index.build(),e.hide(),new A.Notice(`\u2705 Korean Omnisearch index rebuilt! ${this.index.getIndexedCount()} files indexed`,3e3)}catch(n){e.hide(),console.error("\u274C Failed to rebuild index:",n),new A.Notice("\u274C Failed to rebuild search index - check console for details",5e3)}}}),this.addCommand({id:"korean-search-help",name:"Korean Omnisearch Guide",callback:()=>{let e=`\u{1F50D} Korean Omnisearch Guide:

\u{1F4DD} Search Patterns:
\u2022 \u314E\u3131 \u2192 finds \uD55C\uAE00, \uD56D\uACF5, \uD559\uAD50
\u2022 \uD55C\u3131 \u2192 finds \uD55C\uAD6D, \uD55C\uAE00  
\u2022 \u314E\u3131\u3139\uAD50 \u2192 finds \uD55C\uAE00\uD559\uAD50

\u2328\uFE0F Keyboard Shortcuts:
\u2022 Cmd/Ctrl+Shift+O: Open search
\u2022 \u2191\u2193: Navigate results
\u2022 Enter: Open file
\u2022 Ctrl+Enter: Open in new tab
\u2022 Shift+Enter: Open in new pane

\u{1F4CA} Currently indexed: ${this.index.getIndexedCount()} files`;new A.Notice(e,8e3)}})}async buildIndexProgressively(){try{console.log("\u{1F50D} Building Korean Omnisearch index (ultra-fast mode)...");let e=this.app.vault.getMarkdownFiles(),n=e.length;console.log(`\u{1F4CA} Found ${n} files to index`),this.index.clear();let s=500,i=0,o=null;n>2e3&&(o=new A.Notice(`\u{1F504} Fast indexing ${n} files for Korean Omnisearch...`,0));for(let c=0;c<e.length;c+=s){let d=e.slice(c,c+s),l=await this.index.batchAddFiles(d);if(i+=l,o&&n>2e3&&c%(s*4)===0){let h=Math.round(i/n*100);o.setMessage(`\u{1F504} Korean Omnisearch indexing: ${h}%`)}c+s<e.length&&await new Promise(h=>setTimeout(h,1))}o&&o.hide(),console.log(`\u2705 Korean Omnisearch index completed: ${i} files (ultra-fast mode)`),new A.Notice(`\u{1F389} Korean Omnisearch ready! ${i} files indexed instantly`,3e3)}catch(e){console.error("\u274C Failed to build search index:",e),new A.Notice("\u274C Failed to build search index - check console for details",5e3)}}registerVaultEvents(){this.settings.enableAutoIndex&&(this.registerEvent(this.app.vault.on("create",e=>{e instanceof A.TFile&&e.extension==="md"&&this.index.addFile(e)})),this.registerEvent(this.app.vault.on("delete",e=>{e instanceof A.TFile&&this.index.removeFile(e)})),this.registerEvent(this.app.vault.on("rename",(e,n)=>{e instanceof A.TFile&&this.index.updateOnRename(e,n)})),this.registerEvent(this.app.vault.on("modify",e=>{e instanceof A.TFile&&e.extension==="md"&&this.index.updateFile(e)})))}onunload(){console.log("\u{1F44B} Korean Omnisearch: Unloaded")}async loadSettings(){this.settings=Object.assign({},He,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}getSearchIndex(){return this.index}search(e){return this.index.search(e)}};
