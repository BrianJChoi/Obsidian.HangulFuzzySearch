/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var tt=Object.create;var ce=Object.defineProperty;var nt=Object.getOwnPropertyDescriptor;var st=Object.getOwnPropertyNames;var rt=Object.getPrototypeOf,it=Object.prototype.hasOwnProperty;var ot=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),ct=(n,e)=>{for(var t in e)ce(n,t,{get:e[t],enumerable:!0})},Pe=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of st(e))!it.call(n,i)&&i!==t&&ce(n,i,{get:()=>e[i],enumerable:!(s=nt(e,i))||s.enumerable});return n};var at=(n,e,t)=>(t=n!=null?tt(rt(n)):{},Pe(e||!n||!n.__esModule?ce(t,"default",{value:n,enumerable:!0}):t,n)),lt=n=>Pe(ce({},"__esModule",{value:!0}),n);var Ye=ot((Qt,Ne)=>{(function(){"use strict";var n=["\u3131","\u3132","\u3134","\u3137","\u3138","\u3139","\u3141","\u3142","\u3143","\u3145","\u3146","\u3147","\u3148","\u3149","\u314A","\u314B","\u314C","\u314D","\u314E"],e=["\u314F","\u3150","\u3151","\u3152","\u3153","\u3154","\u3155","\u3156","\u3157",["\u3157","\u314F"],["\u3157","\u3150"],["\u3157","\u3163"],"\u315B","\u315C",["\u315C","\u3153"],["\u315C","\u3154"],["\u315C","\u3163"],"\u3160","\u3161",["\u3161","\u3163"],"\u3163"],t=["","\u3131","\u3132",["\u3131","\u3145"],"\u3134",["\u3134","\u3148"],["\u3134","\u314E"],"\u3137","\u3139",["\u3139","\u3131"],["\u3139","\u3141"],["\u3139","\u3142"],["\u3139","\u3145"],["\u3139","\u314C"],["\u3139","\u314D"],["\u3139","\u314E"],"\u3141","\u3142",["\u3142","\u3145"],"\u3145","\u3146","\u3147","\u3148","\u314A","\u314B","\u314C","\u314D","\u314E"],s=44032,i=["\u3131","\u3132","\u3133","\u3134","\u3135","\u3136","\u3137","\u3138","\u3139","\u313A","\u313B","\u313C","\u313D","\u313E","\u313F","\u3140","\u3141","\u3142","\u3143","\u3144","\u3145","\u3146","\u3147","\u3148","\u3149","\u314A","\u314B","\u314C","\u314D","\u314E"],o=["\u3131","\u3132","\u3134","\u3137","\u3138","\u3139","\u3141","\u3142","\u3143","\u3145","\u3146","\u3147","\u3148","\u3149","\u314A","\u314B","\u314C","\u314D","\u314E"],c=["\u314F","\u3150","\u3151","\u3152","\u3153","\u3154","\u3155","\u3156","\u3157","\u3158","\u3159","\u315A","\u315B","\u315C","\u315D","\u315E","\u315F","\u3160","\u3161","\u3162","\u3163"],a=["","\u3131","\u3132","\u3133","\u3134","\u3135","\u3136","\u3137","\u3139","\u313A","\u313B","\u313C","\u313D","\u313E","\u313F","\u3140","\u3141","\u3142","\u3144","\u3145","\u3146","\u3147","\u3148","\u314A","\u314B","\u314C","\u314D","\u314E"],l=[["\u3131","\u3145","\u3133"],["\u3134","\u3148","\u3135"],["\u3134","\u314E","\u3136"],["\u3139","\u3131","\u313A"],["\u3139","\u3141","\u313B"],["\u3139","\u3142","\u313C"],["\u3139","\u3145","\u313D"],["\u3139","\u314C","\u313E"],["\u3139","\u314D","\u313F"],["\u3139","\u314E","\u3140"],["\u3142","\u3145","\u3144"]],h=[["\u3157","\u314F","\u3158"],["\u3157","\u3150","\u3159"],["\u3157","\u3163","\u315A"],["\u315C","\u3153","\u315D"],["\u315C","\u3154","\u315E"],["\u315C","\u3163","\u315F"],["\u3161","\u3163","\u3162"]],u,d,p,x,A,b;function F(r){for(var f=r.length,w={0:0},m=0;m<f;m++)r[m]&&(w[r[m].charCodeAt(0)]=m);return w}u=F(i),d=F(o),p=F(c),x=F(a);function P(r){for(var f=r.length,w={},m,S,E=0;E<f;E++)m=r[E][0].charCodeAt(0),S=r[E][1].charCodeAt(0),typeof w[m]=="undefined"&&(w[m]={}),w[m][S]=r[E][2].charCodeAt(0);return w}A=P(l),b=P(h);function z(r){return typeof u[r]!="undefined"}function H(r){return typeof d[r]!="undefined"}function T(r){return typeof p[r]!="undefined"}function X(r){return typeof x[r]!="undefined"}function D(r){return 44032<=r&&r<=55203}function I(r,f){return b[r]&&b[r][f]?b[r][f]:!1}function N(r,f){return A[r]&&A[r][f]?A[r][f]:!1}var v=function(r,f){if(r===null)throw new Error("Arguments cannot be null");typeof r=="object"&&(r=r.join(""));for(var w=[],m=r.length,S,E,k,M,C,_=0;_<m;_++){var y=[];M=r.charCodeAt(_),D(M)?(M-=s,k=M%28,E=(M-k)/28%21,S=parseInt((M-k)/28/21),y.push(n[S]),typeof e[E]=="object"?y=y.concat(e[E]):y.push(e[E]),k>0&&(typeof t[k]=="object"?y=y.concat(t[k]):y.push(t[k]))):z(M)?(H(M)?C=n[d[M]]:C=t[x[M]],typeof C=="string"?y.push(C):y=y.concat(C)):T(M)?(C=e[p[M]],typeof C=="string"?y.push(C):y=y.concat(C)):y.push(r.charAt(_)),f?w.push(y):w=w.concat(y)}return w},ne=function(r){return typeof r!="string"?"":(r=v(r),r.join(""))},Z=function(r){typeof r=="string"&&(r=v(r));var f=[],w=r.length,m,S=0,E=-1,k,M=!1;function C(y){var W,O,$,oe,J=0,ee,B="";if(M=!1,!(E+1>y))for(var L=1;;L++){if(L===1){if(O=r[E+L].charCodeAt(0),T(O))if(E+L+1<=y&&T($=r[E+L+1].charCodeAt(0))){f.push(String.fromCharCode(I(O,$))),E=y;return}else{f.push(r[E+L]),E=y;return}else if(!H(O)){f.push(r[E+L]),E=y;return}B=r[E+L]}else if(L===2)if($=r[E+L].charCodeAt(0),H($)){O=N(O,$),B=String.fromCharCode(O),f.push(B),E=y;return}else B=String.fromCharCode((d[O]*21+p[$])*28+s);else L===3?(oe=r[E+L].charCodeAt(0),I($,oe)?$=I($,oe):J=oe,B=String.fromCharCode((d[O]*21+p[$])*28+x[J]+s)):L===4?(ee=r[E+L].charCodeAt(0),N(J,ee)?J=N(J,ee):J=ee,B=String.fromCharCode((d[O]*21+p[$])*28+x[J]+s)):L===5&&(ee=r[E+L].charCodeAt(0),J=N(J,ee),B=String.fromCharCode((d[O]*21+p[$])*28+x[J]+s));if(E+L>=y){f.push(B),E=y;return}}}for(var _=0;_<w;_++){if(m=r[_].charCodeAt(0),!H(m)&&!T(m)&&!X(m)){C(_-1),C(_),S=0;continue}S===0?H(m)?S=1:T(m)&&(S=4):S==1?T(m)?S=2:N(k,m)?S=5:C(_-1):S==2?X(m)?S=3:T(m)?I(k,m)||(C(_-1),S=4):(C(_-1),S=1):S==3?X(m)?!M&&N(k,m)?M=!0:(C(_-1),S=1):H(m)?(C(_-1),S=1):T(m)&&(C(_-2),S=2):S==4?T(m)?I(k,m)?(C(_),S=0):C(_-1):(C(_-1),S=1):S==5&&(T(m)?(C(_-2),S=2):(C(_-1),S=1)),k=m}return C(_-1),f.join("")},U=function(r,f){var w=v(r).join(""),m=v(f).join("");return w.indexOf(m)},Fe=function(r,f){var w=v(r).join(""),m=v(f).join(""),S=v(r,!0),E=new RegExp(m,"gi"),k=[],M;if(!f.length)return[];for(;M=E.exec(w);)k.push(M.index);function C(y){for(var W=0,O=0;W<S.length;++W)if(O+=S[W].length,y<O)return W}function _(y){for(var W=0,O=0;W<S.length;++W)if(O+=S[W].length,y+m.length<=O)return W}return k.map(function(y){return[C(y),_(y)]})};function j(r){this.string=r,this.disassembled=v(r).join("")}j.prototype.search=function(r){return v(r).join("").indexOf(this.disassembled)};var q=function(r){typeof r=="object"&&(r=r.join(""));var f=r.charCodeAt(r.length-1);if(D(f)){f-=s;var w=f%28;if(w>0)return!0}else if(z(f))return!0;return!1},ie=function(r,f){return v(r).pop()===f},ye={disassemble:v,d:v,disassembleToString:ne,ds:ne,assemble:Z,a:Z,search:U,rangeSearch:Fe,Searcher:j,endsWithConsonant:q,endsWith:ie,isHangul:function(r){return typeof r=="string"&&(r=r.charCodeAt(0)),D(r)},isComplete:function(r){return typeof r=="string"&&(r=r.charCodeAt(0)),D(r)},isConsonant:function(r){return typeof r=="string"&&(r=r.charCodeAt(0)),z(r)},isVowel:function(r){return typeof r=="string"&&(r=r.charCodeAt(0)),T(r)},isCho:function(r){return typeof r=="string"&&(r=r.charCodeAt(0)),H(r)},isJong:function(r){return typeof r=="string"&&(r=r.charCodeAt(0)),X(r)},isHangulAll:function(r){if(typeof r!="string")return!1;for(var f=0;f<r.length;f++)if(!D(r.charCodeAt(f)))return!1;return!0},isCompleteAll:function(r){if(typeof r!="string")return!1;for(var f=0;f<r.length;f++)if(!D(r.charCodeAt(f)))return!1;return!0},isConsonantAll:function(r){if(typeof r!="string")return!1;for(var f=0;f<r.length;f++)if(!z(r.charCodeAt(f)))return!1;return!0},isVowelAll:function(r){if(typeof r!="string")return!1;for(var f=0;f<r.length;f++)if(!T(r.charCodeAt(f)))return!1;return!0},isChoAll:function(r){if(typeof r!="string")return!1;for(var f=0;f<r.length;f++)if(!H(r.charCodeAt(f)))return!1;return!0},isJongAll:function(r){if(typeof r!="string")return!1;for(var f=0;f<r.length;f++)if(!X(r.charCodeAt(f)))return!1;return!0}};typeof define=="function"&&define.amd?define(function(){return ye}):typeof Ne!="undefined"?Ne.exports=ye:window.Hangul=ye})()});var Wt={};ct(Wt,{default:()=>me});module.exports=lt(Wt);var Se=require("obsidian");var te=require("obsidian"),$e={fuzzyThreshold:.4,overrideQuickSwitcher:!0},ae=class extends te.PluginSettingTab{constructor(t,s){super(t,s);this.plugin=s}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Hangul Fuzzy Search Settings"}),new te.Setting(t).setName("Fuzzy search threshold").setDesc("Search sensitivity (0: exact match, 1: very loose match)").addSlider(c=>c.setLimits(0,1,.1).setValue(this.plugin.settings.fuzzyThreshold).setDynamicTooltip().onChange(async a=>{this.plugin.settings.fuzzyThreshold=a,await this.plugin.saveSettings(),this.plugin.index.updateThreshold(a)})),new te.Setting(t).setName("Override Quick Switcher").setDesc("Replace default Quick Switcher (Cmd/Ctrl+O) with Hangul search").addToggle(c=>c.setValue(this.plugin.settings.overrideQuickSwitcher).onChange(async a=>{this.plugin.settings.overrideQuickSwitcher=a,await this.plugin.saveSettings(),this.containerEl.createEl("div",{text:"Please restart the plugin for this change to take effect.",cls:"setting-item-description"})}));let o=new te.Setting(t).setName("Search examples").setDesc("Try these search patterns:").settingEl.createDiv({cls:"hangul-search-examples"}).createEl("ul");o.createEl("li").innerHTML='<strong>\uCD08\uC131:</strong> "\u314E\u3131" \u2192 "\uD55C\uAE00", "\uD56D\uACF5", "\uD559\uAD50"',o.createEl("li").innerHTML='<strong>\uBD80\uBD84 \uC74C\uC808:</strong> "\uD55C\u3131" \u2192 "\uD55C\uAD6D", "\uD55C\uAE00"',o.createEl("li").innerHTML='<strong>\uD63C\uD569:</strong> "\u314E\u3131\u3139\uAD50" \u2192 "\uD55C\uAE00\uD559\uAD50"'}};function K(n){return Array.isArray?Array.isArray(n):Qe(n)==="[object Array]"}var ht=1/0;function ut(n){if(typeof n=="string")return n;let e=n+"";return e=="0"&&1/n==-ht?"-0":e}function ft(n){return n==null?"":ut(n)}function G(n){return typeof n=="string"}function Ve(n){return typeof n=="number"}function dt(n){return n===!0||n===!1||gt(n)&&Qe(n)=="[object Boolean]"}function Ke(n){return typeof n=="object"}function gt(n){return Ke(n)&&n!==null}function R(n){return n!=null}function xe(n){return!n.trim().length}function Qe(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}var pt="Incorrect 'index' type",mt=n=>`Invalid value for key ${n}`,St=n=>`Pattern length exceeds max of ${n}.`,yt=n=>`Missing ${n} property in key`,xt=n=>`Property 'weight' in key '${n}' must be a positive integer`,ze=Object.prototype.hasOwnProperty,Ee=class{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(s=>{let i=Ue(s);t+=i.weight,this._keys.push(i),this._keyMap[i.id]=i,t+=i.weight}),this._keys.forEach(s=>{s.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function Ue(n){let e=null,t=null,s=null,i=1,o=null;if(G(n)||K(n))s=n,e=De(n),t=Ce(n);else{if(!ze.call(n,"name"))throw new Error(yt("name"));let c=n.name;if(s=c,ze.call(n,"weight")&&(i=n.weight,i<=0))throw new Error(xt(c));e=De(c),t=Ce(c),o=n.getFn}return{path:e,id:t,weight:i,src:s,getFn:o}}function De(n){return K(n)?n:n.split(".")}function Ce(n){return K(n)?n.join("."):n}function Et(n,e){let t=[],s=!1,i=(o,c,a)=>{if(R(o))if(!c[a])t.push(o);else{let l=c[a],h=o[l];if(!R(h))return;if(a===c.length-1&&(G(h)||Ve(h)||dt(h)))t.push(ft(h));else if(K(h)){s=!0;for(let u=0,d=h.length;u<d;u+=1)i(h[u],c,a+1)}else c.length&&i(h,c,a+1)}};return i(n,G(e)?e.split("."):e,0),s?t:t[0]}var Ct={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},At={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(n,e)=>n.score===e.score?n.idx<e.idx?-1:1:n.score<e.score?-1:1},_t={location:0,threshold:.6,distance:100},vt={useExtendedSearch:!1,getFn:Et,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},g={...At,...Ct,..._t,...vt},wt=/[^ ]+/g;function Mt(n=1,e=3){let t=new Map,s=Math.pow(10,e);return{get(i){let o=i.match(wt).length;if(t.has(o))return t.get(o);let c=1/Math.pow(o,.5*n),a=parseFloat(Math.round(c*s)/s);return t.set(o,a),a},clear(){t.clear()}}}var se=class{constructor({getFn:e=g.getFn,fieldNormWeight:t=g.fieldNormWeight}={}){this.norm=Mt(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((t,s)=>{this._keysMap[t.id]=s})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,G(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){let t=this.size();G(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,s=this.size();t<s;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!R(e)||xe(e))return;let s={v:e,i:t,n:this.norm.get(e)};this.records.push(s)}_addObject(e,t){let s={i:t,$:{}};this.keys.forEach((i,o)=>{let c=i.getFn?i.getFn(e):this.getFn(e,i.path);if(R(c)){if(K(c)){let a=[],l=[{nestedArrIndex:-1,value:c}];for(;l.length;){let{nestedArrIndex:h,value:u}=l.pop();if(R(u))if(G(u)&&!xe(u)){let d={v:u,i:h,n:this.norm.get(u)};a.push(d)}else K(u)&&u.forEach((d,p)=>{l.push({nestedArrIndex:p,value:d})})}s.$[o]=a}else if(G(c)&&!xe(c)){let a={v:c,n:this.norm.get(c)};s.$[o]=a}}}),this.records.push(s)}toJSON(){return{keys:this.keys,records:this.records}}};function Be(n,e,{getFn:t=g.getFn,fieldNormWeight:s=g.fieldNormWeight}={}){let i=new se({getFn:t,fieldNormWeight:s});return i.setKeys(n.map(Ue)),i.setSources(e),i.create(),i}function It(n,{getFn:e=g.getFn,fieldNormWeight:t=g.fieldNormWeight}={}){let{keys:s,records:i}=n,o=new se({getFn:e,fieldNormWeight:t});return o.setKeys(s),o.setIndexRecords(i),o}function le(n,{errors:e=0,currentLocation:t=0,expectedLocation:s=0,distance:i=g.distance,ignoreLocation:o=g.ignoreLocation}={}){let c=e/n.length;if(o)return c;let a=Math.abs(s-t);return i?c+a/i:a?1:c}function bt(n=[],e=g.minMatchCharLength){let t=[],s=-1,i=-1,o=0;for(let c=n.length;o<c;o+=1){let a=n[o];a&&s===-1?s=o:!a&&s!==-1&&(i=o-1,i-s+1>=e&&t.push([s,i]),s=-1)}return n[o-1]&&o-s>=e&&t.push([s,o-1]),t}var Y=32;function Tt(n,e,t,{location:s=g.location,distance:i=g.distance,threshold:o=g.threshold,findAllMatches:c=g.findAllMatches,minMatchCharLength:a=g.minMatchCharLength,includeMatches:l=g.includeMatches,ignoreLocation:h=g.ignoreLocation}={}){if(e.length>Y)throw new Error(St(Y));let u=e.length,d=n.length,p=Math.max(0,Math.min(s,d)),x=o,A=p,b=a>1||l,F=b?Array(d):[],P;for(;(P=n.indexOf(e,A))>-1;){let I=le(e,{currentLocation:P,expectedLocation:p,distance:i,ignoreLocation:h});if(x=Math.min(I,x),A=P+u,b){let N=0;for(;N<u;)F[P+N]=1,N+=1}}A=-1;let z=[],H=1,T=u+d,X=1<<u-1;for(let I=0;I<u;I+=1){let N=0,v=T;for(;N<v;)le(e,{errors:I,currentLocation:p+v,expectedLocation:p,distance:i,ignoreLocation:h})<=x?N=v:T=v,v=Math.floor((T-N)/2+N);T=v;let ne=Math.max(1,p-v+1),Z=c?d:Math.min(p+v,d)+u,U=Array(Z+2);U[Z+1]=(1<<I)-1;for(let j=Z;j>=ne;j-=1){let q=j-1,ie=t[n.charAt(q)];if(b&&(F[q]=+!!ie),U[j]=(U[j+1]<<1|1)&ie,I&&(U[j]|=(z[j+1]|z[j])<<1|1|z[j+1]),U[j]&X&&(H=le(e,{errors:I,currentLocation:q,expectedLocation:p,distance:i,ignoreLocation:h}),H<=x)){if(x=H,A=q,A<=p)break;ne=Math.max(1,2*p-A)}}if(le(e,{errors:I+1,currentLocation:p,expectedLocation:p,distance:i,ignoreLocation:h})>x)break;z=U}let D={isMatch:A>=0,score:Math.max(.001,H)};if(b){let I=bt(F,a);I.length?l&&(D.indices=I):D.isMatch=!1}return D}function Ot(n){let e={};for(let t=0,s=n.length;t<s;t+=1){let i=n.charAt(t);e[i]=(e[i]||0)|1<<s-t-1}return e}var he=class{constructor(e,{location:t=g.location,threshold:s=g.threshold,distance:i=g.distance,includeMatches:o=g.includeMatches,findAllMatches:c=g.findAllMatches,minMatchCharLength:a=g.minMatchCharLength,isCaseSensitive:l=g.isCaseSensitive,ignoreLocation:h=g.ignoreLocation}={}){if(this.options={location:t,threshold:s,distance:i,includeMatches:o,findAllMatches:c,minMatchCharLength:a,isCaseSensitive:l,ignoreLocation:h},this.pattern=l?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;let u=(p,x)=>{this.chunks.push({pattern:p,alphabet:Ot(p),startIndex:x})},d=this.pattern.length;if(d>Y){let p=0,x=d%Y,A=d-x;for(;p<A;)u(this.pattern.substr(p,Y),p),p+=Y;if(x){let b=d-Y;u(this.pattern.substr(b),b)}}else u(this.pattern,0)}searchIn(e){let{isCaseSensitive:t,includeMatches:s}=this.options;if(t||(e=e.toLowerCase()),this.pattern===e){let A={isMatch:!0,score:0};return s&&(A.indices=[[0,e.length-1]]),A}let{location:i,distance:o,threshold:c,findAllMatches:a,minMatchCharLength:l,ignoreLocation:h}=this.options,u=[],d=0,p=!1;this.chunks.forEach(({pattern:A,alphabet:b,startIndex:F})=>{let{isMatch:P,score:z,indices:H}=Tt(e,A,b,{location:i+F,distance:o,threshold:c,findAllMatches:a,minMatchCharLength:l,includeMatches:s,ignoreLocation:h});P&&(p=!0),d+=z,P&&H&&(u=[...u,...H])});let x={isMatch:p,score:p?d/this.chunks.length:1};return p&&s&&(x.indices=u),x}},V=class{constructor(e){this.pattern=e}static isMultiMatch(e){return We(e,this.multiRegex)}static isSingleMatch(e){return We(e,this.singleRegex)}search(){}};function We(n,e){let t=n.match(e);return t?t[1]:null}var Ae=class extends V{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){let t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},_e=class extends V{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){let s=e.indexOf(this.pattern)===-1;return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}},ve=class extends V{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){let t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},we=class extends V{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){let t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},Me=class extends V{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){let t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}},Ie=class extends V{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){let t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},ue=class extends V{constructor(e,{location:t=g.location,threshold:s=g.threshold,distance:i=g.distance,includeMatches:o=g.includeMatches,findAllMatches:c=g.findAllMatches,minMatchCharLength:a=g.minMatchCharLength,isCaseSensitive:l=g.isCaseSensitive,ignoreLocation:h=g.ignoreLocation}={}){super(e),this._bitapSearch=new he(e,{location:t,threshold:s,distance:i,includeMatches:o,findAllMatches:c,minMatchCharLength:a,isCaseSensitive:l,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}},fe=class extends V{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,s,i=[],o=this.pattern.length;for(;(s=e.indexOf(this.pattern,t))>-1;)t=s+o,i.push([s,t-1]);let c=!!i.length;return{isMatch:c,score:c?0:1,indices:i}}},be=[Ae,fe,ve,we,Ie,Me,_e,ue],Je=be.length,Lt=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Ht="|";function kt(n,e={}){return n.split(Ht).map(t=>{let s=t.trim().split(Lt).filter(o=>o&&!!o.trim()),i=[];for(let o=0,c=s.length;o<c;o+=1){let a=s[o],l=!1,h=-1;for(;!l&&++h<Je;){let u=be[h],d=u.isMultiMatch(a);d&&(i.push(new u(d,e)),l=!0)}if(!l)for(h=-1;++h<Je;){let u=be[h],d=u.isSingleMatch(a);if(d){i.push(new u(d,e));break}}}return i})}var Nt=new Set([ue.type,fe.type]),Te=class{constructor(e,{isCaseSensitive:t=g.isCaseSensitive,includeMatches:s=g.includeMatches,minMatchCharLength:i=g.minMatchCharLength,ignoreLocation:o=g.ignoreLocation,findAllMatches:c=g.findAllMatches,location:a=g.location,threshold:l=g.threshold,distance:h=g.distance}={}){this.query=null,this.options={isCaseSensitive:t,includeMatches:s,minMatchCharLength:i,findAllMatches:c,ignoreLocation:o,location:a,threshold:l,distance:h},this.pattern=t?e:e.toLowerCase(),this.query=kt(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){let t=this.query;if(!t)return{isMatch:!1,score:1};let{includeMatches:s,isCaseSensitive:i}=this.options;e=i?e:e.toLowerCase();let o=0,c=[],a=0;for(let l=0,h=t.length;l<h;l+=1){let u=t[l];c.length=0,o=0;for(let d=0,p=u.length;d<p;d+=1){let x=u[d],{isMatch:A,indices:b,score:F}=x.search(e);if(A){if(o+=1,a+=F,s){let P=x.constructor.type;Nt.has(P)?c=[...c,...b]:c.push(b)}}else{a=0,o=0,c.length=0;break}}if(o){let d={isMatch:!0,score:a/o};return s&&(d.indices=c),d}}return{isMatch:!1,score:1}}},Oe=[];function jt(...n){Oe.push(...n)}function Le(n,e){for(let t=0,s=Oe.length;t<s;t+=1){let i=Oe[t];if(i.condition(n,e))return new i(n,e)}return new he(n,e)}var de={AND:"$and",OR:"$or"},He={PATH:"$path",PATTERN:"$val"},ke=n=>!!(n[de.AND]||n[de.OR]),Rt=n=>!!n[He.PATH],Ft=n=>!K(n)&&Ke(n)&&!ke(n),Ge=n=>({[de.AND]:Object.keys(n).map(e=>({[e]:n[e]}))});function Xe(n,e,{auto:t=!0}={}){let s=i=>{let o=Object.keys(i),c=Rt(i);if(!c&&o.length>1&&!ke(i))return s(Ge(i));if(Ft(i)){let l=c?i[He.PATH]:o[0],h=c?i[He.PATTERN]:i[l];if(!G(h))throw new Error(mt(l));let u={keyId:Ce(l),pattern:h};return t&&(u.searcher=Le(h,e)),u}let a={children:[],operator:o[0]};return o.forEach(l=>{let h=i[l];K(h)&&h.forEach(u=>{a.children.push(s(u))})}),a};return ke(n)||(n=Ge(n)),s(n)}function Pt(n,{ignoreFieldNorm:e=g.ignoreFieldNorm}){n.forEach(t=>{let s=1;t.matches.forEach(({key:i,norm:o,score:c})=>{let a=i?i.weight:null;s*=Math.pow(c===0&&a?Number.EPSILON:c,(a||1)*(e?1:o))}),t.score=s})}function $t(n,e){let t=n.matches;e.matches=[],R(t)&&t.forEach(s=>{if(!R(s.indices)||!s.indices.length)return;let{indices:i,value:o}=s,c={indices:i,value:o};s.key&&(c.key=s.key.src),s.idx>-1&&(c.refIndex=s.idx),e.matches.push(c)})}function zt(n,e){e.score=n.score}function Dt(n,e,{includeMatches:t=g.includeMatches,includeScore:s=g.includeScore}={}){let i=[];return t&&i.push($t),s&&i.push(zt),n.map(o=>{let{idx:c}=o,a={item:e[c],refIndex:c};return i.length&&i.forEach(l=>{l(o,a)}),a})}var Q=class{constructor(e,t={},s){this.options={...g,...t},this.options.useExtendedSearch,this._keyStore=new Ee(this.options.keys),this.setCollection(e,s)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof se))throw new Error(pt);this._myIndex=t||Be(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){R(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){let t=[];for(let s=0,i=this._docs.length;s<i;s+=1){let o=this._docs[s];e(o,s)&&(this.removeAt(s),s-=1,i-=1,t.push(o))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){let{includeMatches:s,includeScore:i,shouldSort:o,sortFn:c,ignoreFieldNorm:a}=this.options,l=G(e)?G(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Pt(l,{ignoreFieldNorm:a}),o&&l.sort(c),Ve(t)&&t>-1&&(l=l.slice(0,t)),Dt(l,this._docs,{includeMatches:s,includeScore:i})}_searchStringList(e){let t=Le(e,this.options),{records:s}=this._myIndex,i=[];return s.forEach(({v:o,i:c,n:a})=>{if(!R(o))return;let{isMatch:l,score:h,indices:u}=t.searchIn(o);l&&i.push({item:o,idx:c,matches:[{score:h,value:o,norm:a,indices:u}]})}),i}_searchLogical(e){let t=Xe(e,this.options),s=(a,l,h)=>{if(!a.children){let{keyId:d,searcher:p}=a,x=this._findMatches({key:this._keyStore.get(d),value:this._myIndex.getValueForItemAtKeyId(l,d),searcher:p});return x&&x.length?[{idx:h,item:l,matches:x}]:[]}let u=[];for(let d=0,p=a.children.length;d<p;d+=1){let x=a.children[d],A=s(x,l,h);if(A.length)u.push(...A);else if(a.operator===de.AND)return[]}return u},i=this._myIndex.records,o={},c=[];return i.forEach(({$:a,i:l})=>{if(R(a)){let h=s(t,a,l);h.length&&(o[l]||(o[l]={idx:l,item:a,matches:[]},c.push(o[l])),h.forEach(({matches:u})=>{o[l].matches.push(...u)}))}}),c}_searchObjectList(e){let t=Le(e,this.options),{keys:s,records:i}=this._myIndex,o=[];return i.forEach(({$:c,i:a})=>{if(!R(c))return;let l=[];s.forEach((h,u)=>{l.push(...this._findMatches({key:h,value:c[u],searcher:t}))}),l.length&&o.push({idx:a,item:c,matches:l})}),o}_findMatches({key:e,value:t,searcher:s}){if(!R(t))return[];let i=[];if(K(t))t.forEach(({v:o,i:c,n:a})=>{if(!R(o))return;let{isMatch:l,score:h,indices:u}=s.searchIn(o);l&&i.push({score:h,key:e,value:o,idx:c,norm:a,indices:u})});else{let{v:o,n:c}=t,{isMatch:a,score:l,indices:h}=s.searchIn(o);a&&i.push({score:l,key:e,value:o,norm:c,indices:h})}return i}};Q.version="6.6.2";Q.createIndex=Be;Q.parseIndex=It;Q.config=g;Q.parseQuery=Xe;jt(Te);var je=at(Ye()),ge=class{constructor(e){this.plugin=e;this.entries=[]}async build(){let e=this.plugin.app.vault.getMarkdownFiles();this.entries=e.map(t=>this.toEntry(t)),this.rebuildFuse()}updateOnRename(e,t){let s=this.entries.findIndex(i=>i.path===t);s>-1?this.entries.splice(s,1,this.toEntry(e)):this.entries.push(this.toEntry(e)),this.rebuildFuse()}search(e){let t=je.default.disassemble(e).join("");return this.fuse.search(t).map(s=>s.item)}updateThreshold(e){this.rebuildFuse()}toEntry(e){let t=e.basename;return{display:t,jamo:je.default.disassemble(t).join(""),path:e.path}}rebuildFuse(){this.fuse=new Q(this.entries,{threshold:this.plugin.settings.fuzzyThreshold,keys:["jamo","display"]})}};var Ze=require("obsidian"),pe=class extends Ze.EditorSuggest{constructor(t,s){super(t);this.index=s}onTrigger(t,s,i){let a=s.getLine(t.line).slice(0,t.ch).match(/\[\[([^\]]*?)$/);if(a){let l=t.ch-a[1].length;return{start:{line:t.line,ch:l},end:t,query:a[1]}}return null}getSuggestions(t){let s=t.query;return s?this.index.search(s):this.getRecentFiles()}renderSuggestion(t,s){s.createEl("div",{text:t.display,cls:"hangul-link-title"}),t.path!==t.display&&s.createEl("small",{text:t.path,cls:"hangul-link-path"})}selectSuggestion(t,s){let i=this.app.workspace.activeLeaf;if((i==null?void 0:i.view.getViewType())==="markdown"){let o=i.view.editor;if(o){let c=o.getCursor(),h=o.getLine(c.line).slice(0,c.ch).match(/\[\[([^\]]*?)$/);if(h){let u=c.ch-h[1].length,d={line:c.line,ch:u},p=c;o.replaceRange(t.display+"]]",d,p)}}}}getRecentFiles(){return this.app.vault.getMarkdownFiles().slice(0,10).map(s=>({display:s.basename,jamo:s.basename,path:s.path}))}};var Re=require("obsidian");var qe=require("obsidian"),re=class extends qe.FuzzySuggestModal{constructor(t,s){super(t);this.index=s;this.setPlaceholder("Search files by Hangul (\uCD08\uC131/\uC911\uC131/\uC885\uC131)...")}getItems(){let t=this.inputEl.value;return t?this.index.search(t):[]}getItemText(t){return t.display}onChooseItem(t){this.app.workspace.openLinkText(t.path,"",!1)}renderSuggestion(t,s){let i=t.item;s.createEl("div",{text:i.display,cls:"hangul-switcher-title"}),i.path!==i.display&&s.createEl("small",{text:i.path,cls:"hangul-switcher-path"})}};function et(n){n.addCommand({id:"hangul-quick-switcher",name:"Open Hangul Quick Switcher",callback:()=>{new re(n.app,n.index).open()}}),n.settings.overrideQuickSwitcher&&n.addCommand({id:"hangul-override-quick-switcher",name:"Hangul Quick Switcher (Override)",hotkeys:[{modifiers:["Mod"],key:"o"}],callback:()=>{new re(n.app,n.index).open()}}),n.addCommand({id:"hangul-rebuild-index",name:"Rebuild Hangul Search Index",callback:async()=>{await n.index.build(),new Re.Notice("Hangul search index rebuilt!",3e3)}}),n.addCommand({id:"hangul-open-settings",name:"Open Hangul Search Settings",callback:()=>{new Re.Notice("Go to Settings \u2192 Community plugins \u2192 Hangul Fuzzy Search",5e3)}})}var me=class extends Se.Plugin{async onload(){console.log("Loading Hangul Search Plugin..."),await this.loadSettings(),this.index=new ge(this),await this.index.build(),this.registerEvent(this.app.vault.on("rename",(t,s)=>{t instanceof Se.TFile&&this.index.updateOnRename(t,s)})),et(this),this.registerEditorSuggest(new pe(this.app,this.index)),this.addSettingTab(new ae(this.app,this)),console.log("Hangul Search Plugin loaded successfully.")}onunload(){console.log("Unloading Hangul Search Plugin...")}async loadSettings(){this.settings=Object.assign({},$e,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};
